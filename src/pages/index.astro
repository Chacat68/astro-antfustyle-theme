---
import BaseLayout from '~/layouts/BaseLayout.astro'
import StandardLayout from '~/layouts/StandardLayout.astro'
import LatestPosts from '~/components/widgets/LatestPosts.astro'
import { UI } from '~/config'
import { getLocale, useTranslations } from '~/i18n/translate'

// 随机选择背景类型
const bgTypes = [
  'plum',
  'dot',
  'particle',
  'wave',
  'constellation',
  'firefly',
] as const
const randomBgType = bgTypes[Math.floor(Math.random() * bgTypes.length)]

const frontmatter = {
  title: '关于',
  subtitle: '',
  description: '',
  bgType: randomBgType,
  toc: false,
  ogImage: false,
} as const

const socialLabel = (title: string) => {
  if (title === 'Github') return 'GitHub'
  const onIndex = title.lastIndexOf(' on ')
  return onIndex >= 0 ? title.slice(onIndex + 4) : title
}

const locale = getLocale(Astro.currentLocale)
const t = useTranslations(locale)
---

<BaseLayout
  title={t('page.home.title')}
  description={t('page.home.description')}
  bgType={frontmatter.bgType}
  ogImage={frontmatter.ogImage}
>
  <StandardLayout title={t('page.home.title')} subtitle={frontmatter.subtitle}>
    <Fragment slot="article">
      <p>{t('home.intro1')}</p>
      <p>{t('home.intro2')}</p>

      <p>
        <strong>{t('home.roles')}</strong>
      </p>

      <hr />

      <LatestPosts limit={20} />

      <hr />

      <div>
        <div class="mb-2">{t('home.findMeOn')}</div>
        <div class="flex flex-wrap gap-4">
          {
            UI.socialLinks.map((item) => (
              <a
                href={item.link}
                title={item.title}
                class="inline-flex items-center gap-1.5 op-75 hover:op-100"
              >
                {'icon' in item && (
                  <span class={item.icon} aria-hidden="true" />
                )}
                <span>{socialLabel(item.title)}</span>
              </a>
            ))
          }
        </div>
      </div>

      <hr />

      <p>{t('home.thanks')}</p>
    </Fragment>
  </StandardLayout>
</BaseLayout>
